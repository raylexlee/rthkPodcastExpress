
漢武帝年輕時，寵幸平陽公主家奴婢出身的歌姬衛子夫，陳皇后失寵，其後被廢。衛子夫替武帝生下長子劉據，武帝為了鞏固長子劉據及衛子夫的地位，起用衛子夫的弟弟衛青為大將軍，率領大軍攻伐匈奴。元光六年，即公元前129年，衛青擊敗匈奴，收復陰山、黃河以南秦末失地，設立朔方等郡，立功封長平侯，第二年，即元朔元年，公元前128年，立年僅七歲的劉據為皇太子，立衛子夫為皇后。衛青以外戚兼功臣身分，為皇太子劉據作政治後盾。衛青另一位姊姊衛少兒的兒子霍去病，年僅十八歲，亦攻伐匈奴有功，取得河西走廊，設立武威、張掖、酒泉、敦煌四郡，官拜驃騎將軍，封冠軍侯。而衛氏一家，親貴無比。

然而衛氏出身微賤，世代為平陽侯家的奴婢。《史記．衛將軍列傳》說：「大將軍衞青者，平陽人也。其父鄭季，為吏，給事平陽侯家，與侯妾衞媼通，生青。青同母兄衞長子，而姊衞子夫自平陽公主家得幸天子，故冒姓為衞氏。」他幾姊弟的母親衛媼，是平陽侯家的女奴，所生子女，未必同一父親，所以都跟隨母姓。衛青發之前也說過：「人奴之生，得毋笞罵即足矣」。

根據近年出土的漢初法律文書《張家山漢墓竹簡》，有一則法例：「民為奴妻而有子，子畀奴主」，意思是平民與女奴所生的子女，所有權屬於女奴的主人。因此，衛子夫、衛少兒、衛青姊弟既然是平陽侯家的女奴衛媼所生，身分當然是奴隸。衛少兒的兒子霍去病，也是女奴所生的奴隸。漢朝人稱這種人為「奴生子」或「家生子」。但奴隸身分可以用錢「贖為庶人」，或立軍功「免為庶人」。

漢武帝元封四年以後，開疆拓土的軍事擴張基本上告一段落，漢朝進入盛世高峰，武帝本人已經步入五十歲。武帝對自己在位三十多年所創立的功績非常滿意，於是差不多每年都到外地巡視，日常政務交由留守長安的皇太子劉據處理。而功臣宿將逐漸凋零，皇太子劉據所重用的官員，多數是「守文之臣」「忠厚長者」，而武帝身邊的內朝訶諛奉承近臣格格不入，太子劉據與武帝近臣之間的矛盾加深，大將軍衛青於元封五年，公元前106年病逝，衛皇后亦年老色衰，早已被武帝疏遠，太子劉據背後的政治支柱變得脆弱。元封七年，公元前104年，武帝最寵幸的妃嬪李夫人誕下皇子劉髆，這一年，武帝改年號為「太初」，而且任命李夫人的兄長李廣利為貳師將軍，率領大軍遠征西域的大宛國(大宛國即今日中亞烏茲別克東部的費爾干納盆地)，希望李廣利立功封侯，用意非常明顯，準備以劉髆取代劉據的太子地位。太子劉據及衛皇后當然有所警覺，但史書未有記載太子及皇后有任何反應，在這關鍵時刻，衛皇后的姐夫，即太子劉據的姨丈公孫賀擔任丞相，可見衛家外戚在朝廷仍有相當地位。李廣利征伐大宛國並不順利，至太初四年，即公元前101年，才取得勝利，斬大宛王首，取得汗血天馬，但李夫人已經病死，武帝易儲計劃受到挫折。

武帝征和二年，即公元前91年年初，丞相公孫賀因被人告發以「巫蠱」害人，下獄死，事件牽涉太子劉據的兩個姊姊諸邑公主和陽石公主，亦被武帝處死。同年七月，武帝在甘泉宮避暑，派使者江充等人到赴長安搜查巫蠱，江充等掘太子宮，搜得木偶和符咒，太子與皇后發兵斬江充，武帝認為太子起兵作反，命丞相劉屈氂(音釐)領兵討伐，與太子兵戰於長安，死者數以萬計。太子兵敗逃亡，皇后被迫自殺。幾個月後，太子無路可逃，亦自殺而死，終年三十八歲。太子全家被殺，只留下一位剛出生的皇曾孫，收禁獄中。第二年六月，丞相劉屈氂因為與李廣利密謀以巫蠱幫助劉髆立為太子被揭發，下獄腰斬，而李廣利正在領兵與匈奴作戰，得知事變，投降匈奴。這次延續多年血流成河的宮廷鬥爭，歷史上稱為「巫蠱之禍」。

巫蠱之禍使年老的漢武帝心力交瘁，對太子劉據之死，感到悔疚，頒佈停止對外征伐、與民休息的「輪臺詔」，為太子劉據平反。這次宮廷的巨變，為一位長期在武帝身邊的近臣製造了登上權力階梯的機會，這位近臣就是霍去病的同父異母弟弟霍光。霍光的掌權，為日後漢朝權臣輔政，建立先例，而王莽就是循著這先例，加上外戚身分，掌握漢朝政權。
