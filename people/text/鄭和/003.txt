
明太祖洪武十七年，馬三保與一群戰俘，被明朝征伐雲南大軍押送返回京城應天府，亦即今日的南京市。由於馬三保尚未成年，於是被挑選入宮為奴僕。古代中國宮中僕人稱為「宦官」，為了確保皇室血統純正，必須「淨身」。所謂「淨身」就是做過閹割手術，切去男性生殖器官，成為沒有生殖能力的人。古代中國宦官的來源，主要是未成年的戰俘孩童、自願閹割的死刑罪犯，或者貧窮人家小孩被閹割之後送入宮中。宦官多數出身寒微，學識淺陋，社會背景薄弱，皇帝的信任和宮廷的勢力成為生存依靠。

古代中國宦官的職位經歷過不少變化，春秋戰國時期，有所謂「寺人」或「閹人」；秦漢時期，有「內侍」、「常侍」、「中常侍」、「中尚書」、「黃門」等職位和稱號及職位。隨著皇帝權力越來越集中，皇帝居住於深宮之中，與大臣關係越來越疏離，皇帝必須通過宦官向大臣傳達詔令，於是宦官因親近皇帝，權勢得以坐大。到了東漢，一些宦官因為協助皇帝從外戚手中奪回政權，得以封侯拜爵，操控朝政，形成政治派系。魏武帝曹操便是出自宦官家庭，他的祖父是漢桓帝時的大宦官中常侍費亭侯曹騰，父親曹嵩是曹騰養子。但是宦官出身寒微，雖然權勢顯赫，往往被士大夫所鄙視。

唐朝安史之亂之後，一部分地方藩鎮擁兵割據，皇權受到威脅，於是皇帝派遣親信宦官掌管禁衛，或者出任監軍，於是宦官勢力膨脹，甚至廢立皇帝，宦官權勢到達歷史上的高峰。五代兩宋時期，雖然出現過宋徽宗寵信的大宦官童貫，但整情況，宦官權力仍然受到限制、約束，宦官干政並不嚴重。元朝皇帝保持游牧民族習慣，宮廷事務由蒙古大汗親信侍衛負責，宦官權力不大；到了元朝末年，元順帝後期，順帝不理政務，來自高麗國的奇皇后與皇太子爭權，奇皇后借助宦官朴不花的幫助，得以干預朝政，但不久天下大亂，元朝滅亡。

明太祖開國之後，宮中雖然有宦官照料宮廷生活起居，但人數不多，大約只有幾百人。而且明太祖嚴禁宦官干政，規定宦官官階最高只有四品，不准讀書識字，而且在宮中立下鐵牌，上面有：「内臣不得干預政事，預者斬」十個大字。但明太祖後期，經常派遣宦官到邊疆地方以絲綢、茶葉交換馬匹。例如洪武八年(1375年)五月，派宦官趙成往陝西河州向青海番人收購马匹；洪武十六年(1383年)九月，宦官梁珉奉旨到琉球國買馬，共得九百八十三匹；洪武二十五年(1392年)二月，尚膳太監而聶、司禮太監慶童奉旨到陕西河州買馬，以三十多萬斤茶葉換得一萬多匹良馬，後來分配給河南、山西、陝西的衛所騎士。

明太祖時期，宦官人數日益增多，分工也日漸精密。洪武十七年(1384年)，明太祖重組内官架構，設立九監、二庫、六局，九監即：内官監、神宫監、尚寶監、尚衣監、尚膳監、司設監、司禮監、御馬監、直殿監；二庫即：内承運庫、司鑰庫；六局即：巾帽局、針工局、織染局、顏料局、司苑局、司牧局。太祖之後，宦官架構不斷擴充，宮中的宦官人數增至數萬人，而宦官機構發展為二十四衙門：十二監、四司、八局，宦官權勢越來越大。
