
崇禎十年（1637年）六月，崇禎皇帝重用口才出眾、以軍事謀略自負的文臣楊嗣昌為禮部尚書兼東閣大學士，入參機務，統籌剿滅流寇戰略。初期頗有成效，各路流寇紛紛向官府投降或退入深山，但由於明朝官軍內部矛盾重重，楊嗣昌為人自負，與大將盧象昇不和，後金第四次越過內蒙古邊牆（長城）南侵，威脅北京，盧象昇在北上勤王，孤軍作戰，奮力戰死，卻被楊嗣昌誣陷「臨陣逃走」，死後加罪。

盧象昇戰死之後，朝廷急調洪承疇北上抵禦後金。洪承疇離開之後，楊嗣昌所策劃的「四正六隅十面網」剿滅流寇策略破局，李自成得以喘息，從商洛山中進入河南。

李自成在河南得到落第秀才牛金星及文士李岩、宋獻策等人入伙，為他出謀劃策，牛金星成為軍師，他建議李自成放棄流寇劫掠行為，改為宣揚為民請命，「少刑殺，賑饑民，收人心」，提出：「開大門，迎闖王，闖王來時不納糧」口號，撰寫檄文聲討河南、湖廣等省明朝宗室諸王欺凌百姓，吸乾民脂民膏的惡行，起兵攻打洛陽福王及開封周王以平民憤，得到大量貧窮農民響應，李自成隊伍迅速發展為數十萬人。

崇禎十四年（1641年）正月，李自成攻陷洛陽，烹殺崇禎帝叔父福王朱常洵。二月初四張獻忠亦從四川突襲，攻陷湖廣襄陽，處死襄王朱翊銘。二王遇害，朝野震動，楊嗣昌惶懼憂憤，嘔血而死。

崇禎十四年二月至十五年九月，李自成三次圍攻開封，由於開封城堅固，難以攻破，最後一攻，決黃河大堤水淹開封城，城牆崩壞，李自成攻入開封城，擒殺周王朱恭枵。河南全省被李自成佔據。

同一時期，崇禎十三年（1640年），後金天聰汗皇太極已經稱帝，改國號「大清」，冬天，清兵向錦州發動進攻，明軍敗於塔山、杏山，十四年（1641年）春，遼薊總督洪承疇為挽救錦州危局，親自率領八總兵、十三萬人集結寧遠。三月，皇太極圍攻錦州，洪承疇準備以逸待勞，與清軍決戰，但八總兵各懷異心，不服從洪承疇號令，迫逼出戰。洪承疇拖垮清軍之方略因此無法實施，不得已出戰，卻陷入清軍包圍，明軍糧道斷絕，突圍途中，各軍不待軍令，爭先退走，清軍趁勢掩殺。洪承疇率萬人殘兵坐困松山城，突圍屢不成。翌年城陷，洪承疇兵敗被俘。
