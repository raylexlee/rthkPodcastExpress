明崇禎九年，明朝的內憂外患越來越嚴峻，西北各省流寇橫行攻掠，蔓延至中原的河南、湖廣，甚至侵擾明朝皇室祖宗家鄉鳳陽，官軍應接不暇。洪承疇調往薊遼，保衛京師之後，西北各省征剿流寇軍務，雖要另覓人選。據《明史．楊嗣昌傳》記述：「九年秋，兵部尚書張鳳翼卒，帝顧廷臣無可任者，即家起嗣昌。」楊嗣昌是進士出身，為人聰明好學，口才極佳，史書稱他「博涉文籍，多識先朝故事，工筆劄，有口辨」。他的父親楊鶴，原任陝西三邊總督，流寇初起時，楊鶴因征剿不力，令流寇坐大，被貶流放。楊嗣昌亦退隱林下，但經常發表一些安邦定國策略的文章，在士大夫之中名氣極大，崇禎帝讀後亦非常讚賞，於是召楊嗣昌入朝，《明史》謂：「帝與語，大信愛之。……嗣昌銳意振刷，帝益以為能。每對必移時，所奏請無不聽。」楊嗣昌深受崇禎帝信任，任命他為兵部尚書，兼任大學士，崇禎帝甚至對楊嗣昌說：「恨用卿晚。」

楊嗣昌認為，明朝要同時對付橫行西北的流寇，以及威脅東北的清國，只會令朝廷筋疲力竭，於是建議「先安內，後攘外」，即暫時與清國議和，承認清國地位，減輕東北邊境壓力，集中力量剿滅流寇。楊嗣昌所提出的征剿流寇方略，是建立「四正、六隅，十面網」的圍剿軍事部署，「陜西、河南、湖廣、江北為四正，四巡撫分剿而專防；以延綏、山西、山東、江南、江西、四川為六隅，六巡撫分防而協剿；是謂十面之網」，各地總督、將領因應流寇活動，隨時征剿。又建議增兵十二萬，增餉二百八十萬，所增軍餉向農民加徵賦稅，稱為「剿餉」。崇禎帝向臣民頒布詔諭：「流寇延蔓，生民塗炭，不集兵無以平寇，不增賦無以餉兵。勉從廷議，暫累吾民一年，除此腹心大患。其改因糧為均輸，布告天下，使知為民去害之意。」楊嗣昌又起用平定福建海盜有功的大將熊文燦負責征剿流寇軍務。崇禎帝及楊嗣昌期望一年之內，能平定流寇之亂。

楊嗣昌所設計的「先安內、後攘外」，「四正、六隅，十面網」方略，在崇禎十二年（1639年）破局。流寇張獻忠被官兵圍困，假意投降熊文燦，脫險之後降而復叛，佔據湖廣穀城縣，大敗明將左良玉，再進入湖廣、四川邊界。熊文燦因此下獄而死，楊嗣昌親自到襄陽督師，官兵屢敗，崇禎十三年楊嗣昌發病死於軍中。陝西各路流寇亦乘機突圍，到處攻掠，一發不可收拾。

流寇張獻忠的隊伍從湖廣進入四川；李自成的隊伍從湖廣北上河南，趁河南發生饑荒，聚集數十萬饑民，向洛陽、開封進發。李自成在河南得到落第秀才牛金星，以及地方豪傑李岩等讀書人加盟，建議他改變流寇劫掠的性質，制定軍紀，提出打擊貪官污吏、為民請命的宣傳，揭露明朝藩王的奢侈荒淫，每攻破一城，即沒收藩王、土豪財產，開倉賑濟，分派給貧民，以「開大門，迎闖王，闖王來時不納糧」為口號。於是人心振奮，李自成大軍所向披靡，崇禎十四、十五年，接連攻破洛陽、開封，殺死萬曆帝愛子福王朱常洵，及太祖第五子周王的後人。李自成橫掃河南之後，率領百萬大軍進入陝西。藩王被殺，朝廷大為震動，但已束手無策。

崇禎十七年，公元1644年正月初一，李自成在西安稱王，國號為「大順」，年號永昌。
