
魏明帝太和二年(公元228年)夏，丞相諸葛亮北伐，魏國關中震動，《三國志．魏明帝紀》這樣記載：「蜀大將諸葛亮寇邊，天水、南安、安定三郡吏民叛應亮。遣大將軍曹真都督關右，并進兵。右將軍張郃擊亮於街亭，大破之，亮敗走」，魏明帝倚重的抗蜀主帥是大將軍曹真。直至太和四年春，「以大將軍曹真為大司馬；驃騎將軍司馬宣王為大將軍，(中略)詔大司馬曹真，大將軍司馬宣王伐蜀」，司馬懿被調派從宛城前往關中協助曹真伐蜀。於是司馬懿「自西城卓斫山(斫音啄，斬伐森林)開道，水陸並進，溯沔而上(沿沔水逆流而上)」，抵達關中，拔取長安附近的新豐縣。這是司馬懿初入關中的戰績。次年三月，曹真病逝，於是魏明帝任命司馬懿代替曹真「西屯長安，都督雍、梁二州諸軍事，統車騎將軍張郃、後將軍費曜、征蜀護軍戴淩、雍州刺史郭淮等討亮」。司馬懿成為對抗蜀丞相諸葛亮的主帥，於是發生小說戲曲中的「空城計」傳說。據正史記述，是司馬懿採取「堅壁清野」拖延戰術，堅守城池，不出城應戰，使諸葛亮的北伐師老無功，後援困難。

諸葛亮在青龍二年(234年)八月病逝，蜀國北伐軍撤退，司馬懿仍然鎮守關中，戒備蜀國。這期間，司馬懿建立并鞏固在關中的影響力，他的次弟司馬孚任度支尚書(度音鐸，主管財政及會計)，從冀州(河北)徵調農丁五千人到關中屯田，而且開通成國渠，築臨晉陂(音卑，水庫)，溉田數千頃，「關中軍國有餘」，甚至有盈餘「運粟五百萬斛輸於京師」，可見司馬懿對經營關中非常著力。

景初二年(238年)正月，司馬懿在長安接到魏明帝詔書：「太尉司馬懿帥師伐遼東」。遼東就是今日的遼寧省、吉林省東部和朝鮮半島。漢朝末年天下大亂，遼東土豪公孫度趁機聚集兵馬控制遼東、遼西、玄菟、及位於朝鮮半島的樂浪郡，又跨海攻佔山東半島上的東萊郡，實行割據立國，自稱燕王、平州牧。公孫氏割據遼東差不多四十年，經歷了三代四主，對曹魏的東北方構成嚴重威脅。

尤有甚之，蜀國在劉備死後，丞相諸葛亮主政，第二年，諸葛亮派使者鄧芝到吳國議和，共同對付魏國。魏明帝太和三年(229年)蜀、吳兩國締結盟約，「交分天下」，也就是說一旦魏國滅亡，蜀、吳瓜分魏國疆土：「豫、青、徐、幽屬吳，兗、冀、并、涼屬蜀；司州以函谷關為界，東屬吳，西屬蜀」。據這協議，公孫氏割佔的遼東原本屬於幽州，應隸屬吳國。因此吳主孫權派戰船遠征遼東，卻被公孫氏擊敗。其後孫權改變策略，與公孫淵結盟，準備聯手對付魏國：孫權在東南方進攻魏國的揚州壽春、合肥，公孫淵進攻魏國東北方的幽州涿郡(今北京市)。於是魏明帝在景初元年(237年)七月，派幽州刺史毌丘儉(「毌丘」是姓，「毌」音「貫」，為「貫」的本字，與毋不同，容易混淆) 征伐遼東，《三國志．明帝紀》說：「遣幽州刺史毌丘儉率諸軍及鮮卑、烏丸屯遼東南界，璽書徵公孫淵。淵發兵反，儉進軍討之」，但遇上大雨，遼河水漲，無功而退。次年，即景初二年正月「詔太尉司馬宣王帥衆討遼東」，同時「詔青、兖、幽、冀四州大作海船」。六月，司馬懿大軍進至遼水。公孫淵在遼水旁修築堅壁高壘，阻擊魏軍。司馬懿採用聲東擊西之計，假裝全力進攻壁壘，卻隱蔽主力暗中渡過遼水，直取公孫淵根據地襄平，公孫淵回師救援襄平，司馬懿三戰皆捷，襄平守軍糧食將盡，軍心動搖，開城投降，公孫淵突圍時戰死。據稱，公孫淵聞魏軍來攻，曾求救於孫權，孫權也出兵為其聲援，並寫信給公孫淵說：「司馬懿善用兵，所向無前，深為弟憂也！」孫吳援軍未到，司馬懿已平定遼東各郡。

司馬懿平定遼東公孫氏時，附帶建立了意想不到的外交成果：把倭國使者帶到洛陽，向魏國朝貢。倭國就是古代的日本。《三國志》卷三十《東夷．倭人傳》的記述倭使入朝的全文如下：
「景初二年六月，倭女王遣大夫難升米等詣郡，求詣天子朝獻，太守劉夏遣吏將送詣京都。其年十二月，詔書報倭女王曰：“制詔親魏倭王卑彌呼：帶方太守劉夏遣使送汝大夫難升米、次使都巿牛利奉汝所獻男生口四人，女生口六人、班布二匹二丈，以到。汝所在踰遠，乃遣使貢獻，是汝之忠孝，我甚哀汝。今以汝為親魏倭王，假金印紫綬，裝封付帶方太守假授汝。其綏撫種人，勉為孝順。汝來使難升米、牛利涉遠，道路勤勞，今以難升米為率善中郎將、牛利為率善校尉，假銀印青綬，引見勞賜遣還。今以絳地交龍錦五匹、絳地縐粟罽十張、蒨絳五十匹、紺青五十匹，荅汝所獻貢直。又特賜汝紺地句文錦三匹、細班華五張、白絹五十匹、金八兩、五尺刀二口、銅鏡百枚、真珠、鈆丹各五十斤，皆裝封付難升米、牛利，還到錄受，悉可以示汝國中人，使知國家哀汝，故鄭重賜汝好物也。”」

翻譯為白話文，可以這樣說：
「景初二年六月，倭國的女王派遣大夫難升米等人，來到本郡(樂浪郡)，要求前往朝見天子。太守劉夏派遣郡吏把他們送往京城(洛陽)。同年十二月，皇帝向倭國女王頒下詔書，說：“詔書頒下「親魏倭王卑彌呼」：帶方太守劉夏派遣使者，把你的大夫難升米、次使都巿牛利，攜帶你所呈獻的男性生口四人、女性生口六人、班布二匹二丈，已經到達。你的國土非常遙遠，卻能遣使貢獻，是你的忠孝之心，我對你非常讚賞。現在賜你「親魏倭王」封號，把金印紫綬，裝妥封好，交付帶方太守代我頒授給你。希望你盡力安撫族人，勸勉他們孝順。你派來的使者難升米、牛利涉遠，長途跋涉十分勤勉勞苦，現在封賜難升米為「率善中郎將」、牛利為「率善校尉」，賜給銀印青綬，當面向他們慰勞賞賜，送他們回國。今現在以絳地交龍錦五匹、絳地縐粟罽十張、蒨絳五十匹、紺青五十匹，足以回報你所獻貢的價值。又特別賞賜你紺地句文錦三匹、細班華五張、白絹五十匹、金八兩、五尺刀二口、銅鏡百枚、真珠、鉛丹各五十斤，都包裝封妥善，交給難升米、牛利，回國後查驗接受，可以全部向你的國人展示，使他們知道(我大魏)國家對你的讚賞，因此鄭重給你賞賜好禮物。”」

這段文字，是日本歷史的最早文獻，千百年來日本學者反覆研究，但不少疑點仍然難以釐清。但無論如何，日本第一次派使者到中國京城，是由於司馬懿主導的征伐遼東公孫氏而達成。

